---
title: "Team Project Multivariate Analysis"
author: "Adrian White, Cesar Conejo, Xavier Bryant"
date: "11/14/2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=12, fig.height=6)

options(digits=4)

# Load data
load('rda/clinical_trial_complete.rda')

source("scripts/functions/graph_functions.R")

X <- clinical_trial_complete
color_1 <- "deepskyblue2"


# Remove the file
rm(clinical_trial_complete)
```

### Team members

* Adrian White
* Cesar Conejo: 100443596 (Representative member)
* Xavier Bryant: 100445659


### Introduction data set

We have selected the [CRASH-2](http://biostat.mc.vanderbilt.edu/wiki/pub/Main/DataSets/crash2.html) data set provided by Vanderbilt School of Biostatistics for our project. It describes the outcome of a randomized controlled trial and economic valuation of the effects of tranexamic acid on death, vascular occlusive events and transfusion requirement in bleeding trauma patients. Tranexamic acid reduces bleeding in trauma patients undergoing surgery, but is an expensive treatnment option. The trial's objective was to assess the effects and cost effectiveness of an early administration of this medication. 

Participants of the study were adults with, or at risk of, significant bleeding within 8 hours of injury. Sample randomization was determined by the allocation of an eight digit sequence randomly generated by a computer. Patients and staff were masked to treatment allocation of the tranexamic acid.

We have adjusted the original data set to remove a number of variables that were not relevant to our investigation. We have removed variables regarding the exact surgerical procedures administered to patients, various IDs, and details on the patient outcome. We removed the health outcome columns because of complications regarding missing data, where the boolean structure of the columns relating to specific outcomes, like stroke or pulmonary embolism, left a large number of cases with missing values. Instead, we added a boolean variable for a general outcome of survival to assess the efficacy of the procedure, rather than looking at particular health outcomes in post-surgery for living patients. 

We will be using variables regarding the sex, age, and injury of the patient as well as certain bio metrics, like blood pressure, respiratory and heart rates, details on surgical blood transfusion, and a boolean variable on the survival of the patient. Our selection provides us with a balance of continuous and categorical variables, many of which are boolean, with minimal complications due to missing data.
 

### Summary variables in the data set

The variables in this dataset are the following:

* entryid: (Numerical) Unique Numbers for Entry Forms

* sex: (Boolean) The sex of the patient (Male/Female)

* age : (Numerical) Age of the patient(Years)

* injurytime: (Numerical) Hours since injury (Hours)

* injurytype:	(Categorical) Type of injury {Blunt, Penetrating, Blunt and Penetrating}

* sbp: (Numerical) Systolic Blood Pressure (mmHg)

* rr: (Numerical) Respiratory Rate (rate per minute)

* cc: (Numerical) Central Capillary Refille Time (seconds)

* hr: (Numerical) Heart Rate (rate per minute)

* ndaysicu: (Numerical) Number of days in ICU (days)

* btransf: (Boolean) Blood Products Transfusion

* ncell: (Numerical) Number of Units of Red Call Products Transfused

* nplasma: (Numerical) Number of Units of Fresh Frozen Plasma Transfused

* nplatelets: (Numerical) Number of Units of Platelets Transfused

* ncryo: (Numerical) Number of Units of Cryoprecipitate Transfused

* bvii:	(Boolean) Recombinant Factor VIIa Given

* Death: (Boolean) Indicator if patient survived after the procedure


A summmary of data type is the following

```{r echo=FALSE}
variable <- c("entryid","sex","age","injurytime","injurytype","sbp","rr","cc","hr","ndaysicu","btransf","ncell","nplasma","nplatelets","ncryo","bvii","death")

type_variable <- c("Quantitative","Qualitative","Quantitative","Quantitative","Qualitative","Quantitative","Quantitative","Quantitative","Quantitative","Quantitative","Quanlitative","Quantitative","Quantitative","Quantitative","Quantitative","Qualitative","Qualitative")


sub_type_variable <- c("Continuous","Nominal","Continuous","Continuous","Nominal","Continuous","Continuous","Continuous","Continuous","Discrete","Nominal","Discrete","Discrete","Discrete","Discrete","Nominal","Nominal")

summary.methods <- data.frame(variable,
                              type_variable,
                              sub_type_variable,
                              row.names = NULL)
knitr::kable(summary.methods)
```

\newpage

### Summary and Graphical display

A review of the structure of the dataset is the following:

```{r echo=FALSE}
str(X)
```

A summary of the values in the data set are:

```{r echo=FALSE}
summary(X)
```

\newpage

Finally, the list of different values by column is the following:

```{r echo=FALSE}
apply(X, 2, function(x) length(unique(x)))
```



Some visualizations of the quantitative variables are:

```{r echo=FALSE}
plothist(col_name = "age", df = X, ylabtext = "All participants",  color_1)
```

```{r echo=FALSE}
plothist(col_name = "injurytime", df = X, ylabtext = "All participants",  color_1)
```


```{r echo=FALSE}
plothist(col_name = "sbp", df = X, ylabtext = "All participants",  color_1)
```



```{r echo=FALSE}
plothist(col_name = "rr", df = X, ylabtext = "All participants",  color_1)
```



```{r echo=FALSE}
plothist(col_name = "hr", df = X, ylabtext = "All participants",  color_1)
```



```{r echo=FALSE}
plothist(col_name = "ndaysicu", df = X, ylabtext = "All participants",  color_1)
```


```{r echo=FALSE}
plothist(col_name = "ncell", df = X, ylabtext = "All participants",  color_1)
```



```{r echo=FALSE}
plothist(col_name = "nplasma", df = X, ylabtext = "All participants",  color_1)
```


```{r echo=FALSE}
plothist(col_name = "nplatelets", df = X, ylabtext = "All participants",  color_1)
```


```{r echo=FALSE}
plothist(col_name = "ncryo", df = X, ylabtext = "All participants",  color_1)
```
